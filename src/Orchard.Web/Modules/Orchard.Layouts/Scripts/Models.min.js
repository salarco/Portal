var LayoutEditor;(function(n){Array.prototype.move=function(n,t){this.splice(t,0,this.splice(n,1)[0])};n.childrenFrom=function(t){return _(t).map(function(t){return n.elementFrom(t)})};n.elementFrom=function(t){switch(t.type){case"Grid":return n.Grid.from(t);case"Row":return n.Row.from(t);case"Column":return n.Column.from(t);case"Content":return n.Content.from(t);default:throw new Error('No element with type "'+t.type+'" was found.');}};n.setModel=function(n,t){$(n).scope().element=t};n.getModel=function(n){return $(n).scope().element}})(LayoutEditor||(LayoutEditor={})),function(n){n.Element=function(n,t,i,r,u,f){if(!n)throw new Error("Parameter 'type' is required.");this.type=n;this.data=t;this.htmlId=i;this.htmlClass=r;this.htmlStyle=u;this.isTemplated=f;this.canvas=null;this.parent=null;this.isDropTarget=null;this.setIsFocusedEventHandlers=[];this.setCanvas=function(n){this.canvas=n;!!this.children&&_.isArray(this.children)&&_(this.children).each(function(t){t.setCanvas(n)})};this.getIsActive=function(){return this.canvas?this.canvas.activeElement===this&&!this.getIsFocused():!1};this.getIsTemplated=function(){return this.isTemplated};this.setIsActive=function(n){this.canvas&&(this.canvas.isDragging||(this.canvas.activeElement=n?this:this.parent))};this.getIsFocused=function(){return this.canvas?this.canvas.focusedElement===this:!1};this.setIsFocused=function(){this.canvas&&(this.canvas.isDragging||this.canvas.inlineEditingIsActive||(this.canvas.focusedElement=this,_(this.setIsFocusedEventHandlers).each(function(n){try{n()}catch(t){}})))};this.getIsSelected=function(){return this.getIsFocused()?!0:!!this.children&&_.isArray(this.children)?_(this.children).any(function(n){return n.getIsSelected()}):!1};this.delete=function(){this.getIsTemplated()||!this.parent||this.parent.deleteChild(this)};this.moveUp=function(){this.getIsTemplated()||!this.parent||this.parent.moveChildUp(this)};this.moveDown=function(){this.getIsTemplated()||!this.parent||this.parent.moveChildDown(this)};this.canMoveUp=function(){return this.getIsTemplated()?!1:this.parent?this.parent.canMoveChildUp(this):!1};this.canMoveDown=function(){return this.getIsTemplated()?!1:this.parent?this.parent.canMoveChildDown(this):!1};this.elementToObject=function(){return{type:this.type,data:this.data,htmlId:this.htmlId,htmlClass:this.htmlClass,htmlStyle:this.htmlStyle,isTemplated:this.isTemplated}};this.copy=function(n){var i=this.getInnerText(),t,r;n.setData("text/plain",i);console.log(i);t=this.toObject();t.isTemplated=!1;r=JSON.stringify(t,null,"\t");n.setData("text/json",r)};this.cut=function(n){this.getIsTemplated()||(this.copy(n),this.delete())};this.paste=function(n){!this.parent||this.parent.paste(n)}}}(LayoutEditor||(LayoutEditor={})),function(n){n.Container=function(t,i){this.allowedChildTypes=t;this.children=i;this.isContainer=!0;var r=this;this.setChildren=function(n){this.children=n;_(this.children).each(function(n){n.parent=r})};this.setChildren(i);this.addChild=function(n){!_(this.children).contains(n)&&_(this.allowedChildTypes).contains(n.type)&&this.children.push(n);n.setCanvas(this.canvas);n.parent=this};this.deleteChild=function(n){var t=_(this.children).indexOf(n);t>=0&&(this.children.splice(t,1),n.getIsActive()&&(this.canvas.activeElement=null),n.getIsFocused()&&(this.children.length>t?this.children[t].setIsFocused():t>0?this.children[t-1].setIsFocused():this.setIsFocused()))};this.moveFocusPrevChild=function(n){if(!(this.children.length<2)){var t=_(this.children).indexOf(n);t>0&&this.children[t-1].setIsFocused()}};this.moveFocusNextChild=function(n){if(!(this.children.length<2)){var t=_(this.children).indexOf(n);t<this.children.length-1&&this.children[t+1].setIsFocused()}};this.insertChild=function(n,t){if(!_(this.children).contains(n)){var i=Math.max(_(this.children).indexOf(t),0);this.children.splice(i+1,0,n);n.setCanvas(this.canvas);n.parent=this}};this.moveChildUp=function(n){if(this.canMoveChildUp(n)){var t=_(this.children).indexOf(n);this.children.move(t,t-1)}};this.moveChildDown=function(n){if(this.canMoveChildDown(n)){var t=_(this.children).indexOf(n);this.children.move(t,t+1)}};this.canMoveChildUp=function(n){var t=_(this.children).indexOf(n);return t>0};this.canMoveChildDown=function(n){var t=_(this.children).indexOf(n);return t<this.children.length-1};this.childrenToObject=function(){return _(this.children).map(function(n){return n.toObject()})};this.getInnerText=function(){return _(this.children).reduce(function(n,t){return n+"\n"+t.getInnerText()},"")};this.paste=function(t){var i=t.getData("text/json"),r,u;!i||(r=JSON.parse(i),u=n.elementFrom(r),this.pasteChild(u))};this.pasteChild=function(n){_(this.allowedChildTypes).contains(n.type)?(this.addChild(n),n.setIsFocused()):!this.parent||this.parent.pasteChild(n)}}}(LayoutEditor||(LayoutEditor={})),function(n){n.Canvas=function(t,i,r,u,f,e,o){function h(){var t=n.Grid.from({data:null,htmlId:null,htmlClass:null,htmlStyle:null,isTemplated:!1,children:[]});s.addChild(t);t.setIsFocused()}n.Element.call(this,"Canvas",i,r,u,f,e);n.Container.call(this,["Grid","Content"],o);this.config=t;this.activeElement=null;this.focusedElement=null;this.isDragging=!1;this.inlineEditingIsActive=!1;this.clipboard=null;this.setCanvas(this);var s=this;this.availableAddOperations=[{name:"Grid",invoke:function(){h()}}];this.toObject=function(){var n=this.elementToObject();return n.children=this.childrenToObject(),n}};n.Canvas.from=function(t,i){return new n.Canvas(t,i.data,i.htmlId,i.htmlClass,i.htmlStyle,i.isTemplated,n.childrenFrom(i.children))}}(LayoutEditor||(LayoutEditor={})),function(n){n.Grid=function(t,i,r,u,f,e){function o(t){var r=t>0?n.Column.times(t):[],i=n.Row.from({data:null,htmlId:null,htmlClass:null,htmlStyle:null,isTemplated:!1,children:r});s.addChild(i);i.setIsFocused()}n.Element.call(this,"Grid",t,i,r,u,f);n.Container.call(this,["Row"],e);var s=this;this.availableAddOperations=[{name:"Empty row",invoke:function(){o(0)}},{name:"1 column (of width 12)",invoke:function(){o(1)}},{name:"2 columns (of width 6)",invoke:function(){o(2)}},{name:"3 columns (of width 4)",invoke:function(){o(3)}},{name:"4 columns (of width 3)",invoke:function(){o(4)}},{name:"6 columns (of width 2)",invoke:function(){o(6)}},{name:"12 columns (of width 1)",invoke:function(){o(12)}}];this.toObject=function(){var n=this.elementToObject();return n.children=this.childrenToObject(),n}};n.Grid.from=function(t){return new n.Grid(t.data,t.htmlId,t.htmlClass,t.htmlStyle,t.isTemplated,n.childrenFrom(t.children))}}(LayoutEditor||(LayoutEditor={})),function(n){n.Row=function(t,i,r,u,f,e){function o(){return _(h.children).filter(function(n){return n.type==="Column"}).reduce(function(n,t){return n+t.offset+t.width},0)}var s,h;n.Element.call(this,"Row",t,i,r,u,f);n.Container.call(this,["Column"],e);this.canAddColumn=function(){return!this.getIsTemplated()&&o()<12};this.addColumn=function(){if(this.canAddColumn()){var t=new n.Column(null,null,null,null,12-o(),0,[]);this.addChild(t);t.setIsFocused()}};this.canContractColumnRight=function(n){if(this.getIsTemplated())return!1;var t=_(this.children).indexOf(n);return t>=0?n.width>1:!1};this.contractColumnRight=function(n,t){var i,r;this.canContractColumnRight(n,t)&&(i=_(this.children).indexOf(n),i>=0&&n.width>1&&(n.width--,this.children.length>i+1&&(r=this.children[i+1],t&&r.offset==0?r.width++:r.offset++)))};this.canExpandColumnRight=function(n,t){var i,r;return this.getIsTemplated()?!1:(i=_(this.children).indexOf(n),i>=0)?n.width>=12?!1:this.children.length>i+1?(r=this.children[i+1],t&&r.offset==0?r.width>1:r.offset>0):o()<12:!1};this.expandColumnRight=function(n,t){var i,r;this.canExpandColumnRight(n,t)&&(i=_(this.children).indexOf(n),i>=0&&(this.children.length>i+1&&(r=this.children[i+1],t&&r.offset==0?r.width--:r.offset--),n.width++))};this.canExpandColumnLeft=function(n,t){var i,r;return this.getIsTemplated()?!1:(i=_(this.children).indexOf(n),i>=0)?n.width>=12?!1:i>0&&(r=this.children[i-1],t&&n.offset==0)?r.width>1:n.offset>0:!1};this.expandColumnLeft=function(n,t){var i,r;this.canExpandColumnLeft(n,t)&&(i=_(this.children).indexOf(n),i>=0&&(i>0?(r=this.children[i-1],t&&n.offset==0?r.width--:n.offset--):n.offset--,n.width++))};this.canContractColumnLeft=function(n){if(this.getIsTemplated())return!1;var t=_(this.children).indexOf(n);return t>=0?n.width>1:!1};this.contractColumnLeft=function(n,t){var i,r;this.canContractColumnLeft(n,t)&&(i=_(this.children).indexOf(n),i>=0&&(i>0?(r=this.children[i-1],t&&n.offset==0?r.width++:n.offset++):n.offset++,n.width--))};s=this.pasteChild;this.pasteChild=function(n){n.type=="Column"?this.canAddColumn()&&(n.width=12-o(),s.call(this,n)):!this.parent||this.parent.pasteChild(n)};this.toObject=function(){var n=this.elementToObject();return n.children=this.childrenToObject(),n};h=this};n.Row.from=function(t){return new n.Row(t.data,t.htmlId,t.htmlClass,t.htmlStyle,t.isTemplated,n.childrenFrom(t.children))}}(LayoutEditor||(LayoutEditor={})),function(n){n.Column=function(t,i,r,u,f,e,o,s){function c(){var t=n.Grid.from({data:null,htmlId:null,htmlClass:null,htmlStyle:null,isTemplated:!1,children:[]});h.addChild(t);t.setIsFocused()}n.Element.call(this,"Column",t,i,r,u,f);n.Container.call(this,["Grid","Content"],s);this.width=e;this.offset=o;this.canSplit=function(){return!this.getIsTemplated()&&this.width>1};this.split=function(){if(this.canSplit()){var t=Math.floor(this.width/2),i=n.Column.from({data:null,htmlId:null,htmlClass:null,htmlStyle:null,width:t,offset:0,children:[]});this.width=this.width-t;this.parent.insertChild(i,this);i.setIsFocused()}};this.canContractRight=function(n){return!this.getIsTemplated()&&this.parent.canContractColumnRight(this,n)};this.contractRight=function(n){this.parent.contractColumnRight(this,n)};this.canExpandRight=function(n){return!this.getIsTemplated()&&this.parent.canExpandColumnRight(this,n)};this.expandRight=function(n){this.parent.expandColumnRight(this,n)};this.canExpandLeft=function(n){return!this.getIsTemplated()&&this.parent.canExpandColumnLeft(this,n)};this.expandLeft=function(n){this.parent.expandColumnLeft(this,n)};this.canContractLeft=function(n){return!this.getIsTemplated()&&this.parent.canContractColumnLeft(this,n)};this.contractLeft=function(n){this.parent.contractColumnLeft(this,n)};var h=this;this.availableAddOperations=[{name:"Grid",invoke:function(){c()}}];this.toObject=function(){var n=this.elementToObject();return n.width=this.width,n.offset=this.offset,n.children=this.childrenToObject(),n}};n.Column.from=function(t){return new n.Column(t.data,t.htmlId,t.htmlClass,t.htmlStyle,t.isTemplated,t.width,t.offset,n.childrenFrom(t.children))};n.Column.times=function(t){return _.times(t,function(){return n.Column.from({data:null,htmlId:null,htmlClass:null,isTemplated:!1,width:12/t,offset:0,children:[]})})}}(LayoutEditor||(LayoutEditor={})),function(n){n.Content=function(t,i,r,u,f,e,o,s,h,c){n.Element.call(this,"Content",t,i,r,u,f);this.contentType=e;this.contentTypeLabel=o;this.contentTypeClass=s;this.html=h;this.hasEditor=c;this.getInnerText=function(){return $($.parseHTML("<div>"+this.html+"<\/div>")).text()};this.toObject=function(){return{type:"Content"}};this.toObject=function(){var n=this.elementToObject();return n.contentType=this.contentType,n.contentTypeLabel=this.contentTypeLabel,n.contentTypeClass=this.contentTypeClass,n.html=this.html,n}};n.Content.from=function(t){return new n.Content(t.data,t.htmlId,t.htmlClass,t.htmlStyle,t.isTemplated,t.contentType,t.contentTypeLabel,t.contentTypeClass,t.html,t.hasEditor)}}(LayoutEditor||(LayoutEditor={}));
//# sourceMappingURL=Models.min.js.map
